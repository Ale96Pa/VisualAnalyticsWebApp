<!--
Authors: Alessandro Palma, Stefano Santinelli
Visual Analytics project: world wide suicide rate and analysis
Academic Year: 2019-2020
-->

<!DOCTYPE html>


<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>Suicides rate and analysis</title>
    <link rel="stylesheet" href="libraries/style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script type="text/javascript" src="libraries/d3.js"></script>
    <script type="text/javascript" src="libraries/d3-geo.js"></script>
    <script type="text/javascript" src="libraries/topojson.js"></script>
    <script type="text/javascript" src="libraries/parallelDiagram.js"></script>
    <script type="text/javascript" src="libraries/mainDiagram.js"></script>
    <script type="text/javascript" src="libraries/secondaryDiagrams.js"></script>
    <script type="text/javascript" src="libraries/provenanceBar.js"></script>
    <script type="text/javascript" src="libraries/filterParameter.js"></script>

</head>

<body>

    <div id="mainWrapper">
        <div id="mainDiagram">

        </div>

        <div class="tab">
            <button>Diag1</button>
            <button>Diag2</button>
            <button>Diag3</button>
        </div>
        <div id="secondDiagram">
            <button class="provenanceButton" id="saveOnProvenance">Save on provenance</button>
        </div>
    </div>

    <div id="filterBar">
        <div id="filters">

        </div>
        <div id="selection">
        </div>
        <div id="map">
        </div>
    </div>

    <div id="provenanceBar" >
        <button class="provenanceButton" onclick="window.location.href = 'review.html';">Review</button>
    </div>
</body>

<script>
    var elemToSave = [];
    async function loadData(){
        return data = await d3.csv("dataset/suicidesCopy.csv");
    }
    loadData().then(data =>{
        filters("#filters", data);
        selectionChoices("#selection", data)
        worldMap("map");
        //var test = drawParallelCoordinates("#filterBar", data);

        // pick svg and copy in provenance bar
        //var button = document.getElementById("saveOnProvenance");

        //document.getElementById("saveOnProvenance").onclick=function(){saveSvgFile("provenanceBar", test, elemToSave);}
        //console.log(data);

        ////// DRAW PATTERN OF BARCHART
 /*       filteredData35 = data.filter(function(row) {
            return row['age'] == '35-54';
        });
        filteredData15 = data.filter(function(row) {
            return row['age'] == '15-24';
        });
        filteredData55 = data.filter(function(row) {
            return row['age'] == '55-74';
        });
        filteredData05 = data.filter(function(row) {
            return row['age'] == '05-14';
        });
        filteredData25 = data.filter(function(row) {
            return row['age'] == '25-34';
        });
        filteredData75 = data.filter(function(row) {
            return row['age'] == '75+';
        });

        drawBarChart("#secondDiagram", filteredData35);
        drawBarChart("#secondDiagram", filteredData15);
        drawBarChart("#secondDiagram", filteredData55);
        drawBarChart("#secondDiagram", filteredData05);
        drawBarChart("#secondDiagram", filteredData25);
        drawBarChart("#secondDiagram", filteredData75);
 */       //saveSvgFile("provenanceBar", test);

        //drawLinearChart("#secondDiagram", data);
    });

    async function loadDataCountry(){
        return data = await d3.csv("dataset/suicidesCountryCopy.csv");
    }
    loadDataCountry().then(data =>{
        drawScatterplot("#secondDiagram", data);
    });


    async function loadDataPca(){
        return data = await d3.csv("dataset/states_tsne.csv");
    }
    loadDataPca().then(data =>{
        filteredData = data.filter(function(row) {
            return row['year'] == '1990';
        });
        drawMainDiagram("#mainDiagram", filteredData);

        /*
        var colX = data.map(function(d) { return d.X })
        var colY = data.map(function(d) { return d.Y })
        var XY_array = []
        for (var i = 0; i < colX.length; i++) {
            XY_array[i] = [colX[i], colY[i]];
        }*/
        //console.log(XY_array);

        //drawLinearChart("#secondDiagram", XY_array);
        //console.log(arr);
    });

    //drawLinearChart("#secondDiagram");
    //
    //drawAdditionalDiagram("#secondDiagram", "dataset/suicidesCopy.csv");
    //
</script>

</html>